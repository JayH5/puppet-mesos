# Managed by Puppet
#
# A list of the available options can be seen by running `mesos-slave --help`. Each
# option can be set in two ways:
#
#  * By creating a file in which the value resides (e.g. /etc/mesos-slave/ip or
#    /etc/mesos-slave/resources/mem).
#  * By setting the environment variable MESOS_OPTION_NAME (the option name with a
#    MESOS_ prefix added to it).
#
# Configuration values are searched for first in the environment, thus values set
# in here precede those loaded from /etc/mesos-slave (passed as command line arguments).
#
# If zookeeper URL is not specified, slaves will connect directly
# to specified master (not a fault-tolerant mode)
<% if !@zookeeper.nil? && !@zookeeper.empty? -%>
MASTER="<%= @zookeeper %>"
<% else -%>
MASTER="<%= @master %>:<%= @master_port %>"
<% end -%>

# public slave's ip, must be unique in mesos cluster
<% if @listen_address -%>
IP="<%= @listen_address %>"
<% else -%>
#IP=""
<% end -%>

# Port to listen on (default: 5051)
PORT=<%= @port %>

<% @cgroups.sort.each do |key, val| -%>
CGROUPS_<%= key.upcase %>="<%= val %>"
<% end if @isolation == 'cgroups' -%>

# alternative is to use MESOS_<option> as an envar
# option list is available with /usr/sbin/mesos-slave --help
# EX :
# export MESOS_log_dir=/var/log/mesos

# slave environment variables
<% @env_var.sort.each do |key,val| -%>
export <%= key %>="<%= val %>"
<% end if @env_var -%>
